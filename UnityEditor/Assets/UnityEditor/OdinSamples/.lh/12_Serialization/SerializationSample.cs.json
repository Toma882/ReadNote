{
    "sourceFile": "12_Serialization/SerializationSample.cs",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1763142598932,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1763142598932,
            "name": "Commit-0",
            "content": "using System.Collections.Generic;\r\nusing Sirenix.OdinInspector;\r\nusing Sirenix.Serialization;\r\nusing UnityEngine;\r\n\r\nnamespace OdinSamples.Serialization\r\n{\r\n    /*\r\n        学习要点：\r\n        ----------------------\r\n        Odin Serialization 是 Odin Inspector 提供的强大序列化系统\r\n        它解决了 Unity 原生序列化的诸多限制\r\n\r\n        核心概念：\r\n        ----------------------\r\n        1. SerializedMonoBehaviour / SerializedScriptableObject\r\n           - 继承这些基类，启用 Odin 序列化系统\r\n           - 支持更多类型（Dictionary、接口、抽象类等）\r\n\r\n        2. [OdinSerialize] 特性\r\n           - 标记字段使用 Odin 序列化\r\n           - 支持 Unity 原生不支持的类型\r\n\r\n        3. 支持的序列化类型：\r\n           - Dictionary<TKey, TValue>（Unity 原生不支持）\r\n           - 接口类型（Unity 原生不支持）\r\n           - 抽象类（Unity 原生不支持）\r\n           - 泛型类型（Unity 原生限制多）\r\n           - null 值（Unity 原生限制多）\r\n           - 循环引用（Unity 原生不支持）\r\n\r\n        4. 序列化策略：\r\n           - SerializationPolicies.Unity：兼容 Unity 原生序列化规则\r\n           - SerializationPolicies.Everything：序列化所有字段\r\n           - SerializationPolicies.Strict：严格模式\r\n\r\n        使用场景：\r\n        ----------------------\r\n        - 需要序列化 Dictionary 时\r\n        - 需要序列化接口或抽象类时\r\n        - 需要更灵活的序列化控制时\r\n        - 需要序列化复杂数据结构时\r\n\r\n        注意事项：\r\n        ----------------------\r\n        - 使用 SerializedMonoBehaviour/ScriptableObject 后，所有字段默认使用 Odin 序列化\r\n        - [OdinSerialize] 可以标记特定字段使用 Odin 序列化\r\n        - 与 Unity 原生序列化可以混用（使用 [SerializeField]）\r\n        - 文件大小可能比 Unity 原生序列化稍大（但功能更强大）\r\n        ----------------------\r\n    */\r\n\r\n    /// <summary>\r\n    /// Odin Serialization 序列化系统演示\r\n    /// 展示 Odin 序列化系统相比 Unity 原生序列化的优势\r\n    /// </summary>\r\n    public class SerializationSample : SerializedMonoBehaviour\r\n    {\r\n        [Title(\"1. Dictionary 序列化（Unity 原生不支持）\")]\r\n        [InfoBox(\"Unity 原生序列化不支持 Dictionary，Odin 完全支持！\", InfoMessageType.Info)]\r\n        [OdinSerialize]\r\n        [DictionaryDrawerSettings(KeyLabel = \"精灵GUID\", ValueLabel = \"突出点数据\")]\r\n        private Dictionary<string, Vector2> spritePointDict = new Dictionary<string, Vector2>();\r\n\r\n        [Title(\"2. 接口类型序列化（Unity 原生不支持）\")]\r\n        [InfoBox(\"Unity 原生序列化不支持接口，Odin 支持多态序列化！\", InfoMessageType.Info)]\r\n        [OdinSerialize]\r\n        [LabelText(\"接口类型数据\")]\r\n        private IDataContainer dataContainer;\r\n\r\n        [Title(\"3. 抽象类序列化（Unity 原生不支持）\")]\r\n        [InfoBox(\"Unity 原生序列化不支持抽象类，Odin 支持！\", InfoMessageType.Info)]\r\n        [OdinSerialize]\r\n        [LabelText(\"抽象类数据\")]\r\n        private BaseData baseData;\r\n\r\n        [Title(\"4. 复杂泛型类型序列化\")]\r\n        [InfoBox(\"Unity 原生序列化对泛型支持有限，Odin 支持复杂泛型！\", InfoMessageType.Info)]\r\n        [OdinSerialize]\r\n        [LabelText(\"泛型字典列表\")]\r\n        private List<Dictionary<string, int>> complexGenericList = new List<Dictionary<string, int>>();\r\n\r\n        [Title(\"5. Null 值支持\")]\r\n        [InfoBox(\"Unity 原生序列化对 null 值支持有限，Odin 完全支持！\", InfoMessageType.Info)]\r\n        [OdinSerialize]\r\n        [LabelText(\"可为空的字典\")]\r\n        private Dictionary<string, string> nullableDict;\r\n\r\n        [Title(\"6. 与 Unity 原生序列化混用\")]\r\n        [InfoBox(\"可以在同一个类中混用 Odin 序列化和 Unity 原生序列化\", InfoMessageType.Info)]\r\n        [SerializeField] // Unity 原生序列化\r\n        private int unitySerializedInt = 10;\r\n\r\n        [OdinSerialize] // Odin 序列化\r\n        private Dictionary<string, int> odinSerializedDict = new Dictionary<string, int>();\r\n\r\n        [Title(\"7. 按钮测试\")]\r\n        [Button(\"添加示例数据到字典\")]\r\n        private void AddSampleData()\r\n        {\r\n            spritePointDict[\"sprite_001\"] = new Vector2(0.5f, 1.2f);\r\n            spritePointDict[\"sprite_002\"] = new Vector2(-0.3f, 0.8f);\r\n            spritePointDict[\"sprite_003\"] = new Vector2(0.2f, 1.5f);\r\n            Debug.Log(\"已添加示例数据到字典\");\r\n        }\r\n\r\n        [Button(\"清空字典\")]\r\n        private void ClearDictionary()\r\n        {\r\n            spritePointDict.Clear();\r\n            Debug.Log(\"已清空字典\");\r\n        }\r\n\r\n        [Button(\"测试接口序列化\")]\r\n        private void TestInterfaceSerialization()\r\n        {\r\n            dataContainer = new ConcreteDataContainer { Data = \"接口数据测试\" };\r\n            Debug.Log($\"接口数据: {dataContainer.Data}\");\r\n        }\r\n\r\n        [Button(\"测试抽象类序列化\")]\r\n        private void TestAbstractClassSerialization()\r\n        {\r\n            baseData = new ConcreteData { Value = 42 };\r\n            Debug.Log($\"抽象类数据: {baseData.Value}\");\r\n        }\r\n    }\r\n\r\n    /// <summary>\r\n    /// 接口示例（Unity 原生不支持序列化接口）\r\n    /// </summary>\r\n    public interface IDataContainer\r\n    {\r\n        string Data { get; set; }\r\n    }\r\n\r\n    /// <summary>\r\n    /// 接口实现类\r\n    /// </summary>\r\n    [System.Serializable]\r\n    public class ConcreteDataContainer : IDataContainer\r\n    {\r\n        public string Data { get; set; }\r\n    }\r\n\r\n    /// <summary>\r\n    /// 抽象类示例（Unity 原生不支持序列化抽象类）\r\n    /// </summary>\r\n    public abstract class BaseData\r\n    {\r\n        public abstract int Value { get; set; }\r\n    }\r\n\r\n    /// <summary>\r\n    /// 抽象类实现\r\n    /// </summary>\r\n    [System.Serializable]\r\n    public class ConcreteData : BaseData\r\n    {\r\n        [SerializeField]\r\n        private int value;\r\n\r\n        public override int Value\r\n        {\r\n            get => value;\r\n            set => this.value = value;\r\n        }\r\n    }\r\n\r\n    /// <summary>\r\n    /// ScriptableObject 序列化示例\r\n    /// </summary>\r\n    [CreateAssetMenu(fileName = \"SerializationData\", menuName = \"Odin Samples/Serialization Data\")]\r\n    public class SerializationDataSample : SerializedScriptableObject\r\n    {\r\n        [Title(\"ScriptableObject 中的 Dictionary\")]\r\n        [InfoBox(\"在 ScriptableObject 中使用 Odin 序列化，支持 Dictionary！\", InfoMessageType.Info)]\r\n        [OdinSerialize]\r\n        [DictionaryDrawerSettings(KeyLabel = \"键\", ValueLabel = \"值\")]\r\n        private Dictionary<string, float> dataDict = new Dictionary<string, float>();\r\n\r\n        [Title(\"ScriptableObject 中的接口\")]\r\n        [OdinSerialize]\r\n        private IDataContainer interfaceData;\r\n\r\n        [Button(\"添加数据\")]\r\n        private void AddData()\r\n        {\r\n            dataDict[\"key1\"] = 1.5f;\r\n            dataDict[\"key2\"] = 2.3f;\r\n            dataDict[\"key3\"] = 3.7f;\r\n        }\r\n\r\n        [Button(\"清空数据\")]\r\n        private void ClearData()\r\n        {\r\n            dataDict.Clear();\r\n        }\r\n    }\r\n}\r\n\r\n"
        }
    ]
}